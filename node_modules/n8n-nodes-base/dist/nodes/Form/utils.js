"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.prepareFormData = void 0;
const prepareFormData = (formTitle, formDescription, formSubmittedText, formFields, testRun, instanceId) => {
    var _a, _b, _c, _d;
    const validForm = formFields.length > 0;
    const utm_campaign = instanceId ? `&utm_campaign=${instanceId}` : '';
    const n8nWebsiteLink = `https://n8n.io/?utm_source=n8n-internal&utm_medium=form-trigger${utm_campaign}`;
    if (formSubmittedText === undefined) {
        formSubmittedText = 'Your response has been recorded';
    }
    const formData = {
        testRun,
        validForm,
        formTitle,
        formDescription,
        formSubmittedText,
        n8nWebsiteLink,
        formFields: [],
    };
    if (!validForm) {
        return formData;
    }
    for (const [index, field] of formFields.entries()) {
        const { fieldType, requiredField, multiselect } = field;
        const input = {
            id: `field-${index}`,
            errorId: `error-field-${index}`,
            label: field.fieldLabel,
            inputRequired: requiredField ? 'form-required' : '',
        };
        if (multiselect) {
            input.isMultiSelect = true;
            input.multiSelectOptions =
                (_b = (_a = field.fieldOptions) === null || _a === void 0 ? void 0 : _a.values.map((e, i) => ({
                    id: `option${i}`,
                    label: e.option,
                }))) !== null && _b !== void 0 ? _b : [];
        }
        else if (fieldType === 'dropdown') {
            input.isSelect = true;
            const fieldOptions = (_d = (_c = field.fieldOptions) === null || _c === void 0 ? void 0 : _c.values) !== null && _d !== void 0 ? _d : [];
            input.selectOptions = fieldOptions.map((e) => e.option);
        }
        else {
            input.isInput = true;
            input.type = fieldType;
        }
        formData.formFields.push(input);
    }
    return formData;
};
exports.prepareFormData = prepareFormData;
//# sourceMappingURL=utils.js.map